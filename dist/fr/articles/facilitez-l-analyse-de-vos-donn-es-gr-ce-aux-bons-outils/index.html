<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Independant business consultant, proficient developer. Focused on improving efficiency through technology."><meta name="keywords" content="Technology,Business Tools,Website,Consulting"><meta name="author" content="Charles-Henri Decultot"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"><link rel="stylesheet" href="../../../styles/main.css"><link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon"><title>Charles-Henri Decultot | Consultant en Technologies</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      
ga('create', 'UA-35025071-2', 'auto');
ga('send', 'pageview');        

</script></head><body class="blue-grey lighten-5 blue-grey-text text-darken-2"> <header><div class="chip"><a href="/fr"><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" d="M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z">         </path></svg></a></div></header><main><div class="container"><section id="article" class="row"><div class="col s12"><div class="card"><div class="card-image"><img src="../../../images/heroImages/semanticAnalysis.png"><span class="card-title">Facilitez l'analyse de vos données grâce aux bons outils</span></div><div class="card-content"><div id="blogNav" class="row"><div id="blogHeader"><img id="logo" src="../../../images/CH-round.png" alt="Charles-Henri Decultot" class="circle"><div id="blogInfo"><strong>Charles-Henri Decultot</strong><br><span>9 septembre 2016</span></div></div><div id="socialSharing" class="fixed-action-btn waves-effect waves-light horizontal click-to-toggle"><a href="#"><i class="material-icons">share</i></a><ul><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.chdecultot.com%2Ffr%2Farticles%2Ffacilitez-l-analyse-de-vos-donn-es-gr-ce-aux-bons-outils%2F" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i><img src="../../../images/facebook-48x48.png" srcset="../../../images/facebook-24x24.png 1x, ../../../images/facebook-48x48.png 2x" alt="Facebook Logo"></i></a></li><li><a href="https://plus.google.com/share?url=https%3A%2F%2Fwww.chdecultot.com%2Ffr%2Farticles%2Ffacilitez-l-analyse-de-vos-donn-es-gr-ce-aux-bons-outils%2F" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i><img src="../../../images/Google+-48x48.png" srcset="../../../images/Google+-24x24.png 1x, ../../../images/Google+-48x48.png 2x" alt="Google+ Logo"></i></a></li><li><a href="https://twitter.com/intent/tweet?text=Facilitez l'analyse de vos données grâce aux bons outilsurl=https%3A%2F%2Fwww.chdecultot.com%2Ffr%2Farticles%2Ffacilitez-l-analyse-de-vos-donn-es-gr-ce-aux-bons-outils%2F" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i><img src="../../../images/Twitter-48x48.png" srcset="../../../images/Twitter-24x24.png 1x, ../../../images/Twitter-48x48.png 2x" alt="Twitter Logo"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.chdecultot.com%2Ffr%2Farticles%2Ffacilitez-l-analyse-de-vos-donn-es-gr-ce-aux-bons-outils%2F&amp;title=Facilitez l'analyse de vos données grâce aux bons outils&amp;summary=Un exemple d'analyse de données en utilisant Python/Pandas au lieu d'Excel sur de larges échantillons de données. Gagnez du temps pour extraire plus de valeur de vos données.&amp;source=Charles-Henri Decultot" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i><img src="../../../images/Linkedin-48x48.png" srcset="../../../images/Linkedin-24x24.png 1x, ../../../images/Linkedin-48x48.png 2x" alt="LinkedIn Logo"></i></a></li></ul></div><div id="blogContent"><article><p>Pour ce premier article, considérons un cas réel.<br><br/>  </p>
<p>Il y a quelques semaines, le client d&#39;un ami lui a demandé d&#39;analyser rapidement des données brutes extraites de leur CRM (logiciel de gestion de la relation client).  </p>
<p>Chaque jour il reçoit des extraits venant du monde entier au format <code>.csv</code>. Il doit ensuite vérifier la présence de certains mots considérés comme choquants au sein des commentaires entrés par les commerciaux au sujets de leurs prospects ou clients.  </p>
<p><strong>Problème</strong>: Il n&#39;avait pas d&#39;autre outil qu&#39;Excel pour faire cette analyse efficacement de manière quotidienne sur des fichiers comprenant des milliers d&#39;entrées chacun.  </p>
<h5 id="trouver-les-bons-outils">Trouver les bons outils</h5>
<p>Excel est un outil d&#39;analyse utile et suffisant pour traiter de petits fichiers ponctuellement, car il est flexible et la plupart des gens le connaisse mieux qu&#39;aucun autre logiciel.<br><br/>  </p>
<p>Même si l&#39;usage d&#39;Excel peut être considérablement amélioré grâce à la création de macros, il  manque de puissance pour gérer de gros fichiers sans risque de crash ou de blocage complet de l&#39;ordinateur lorsqu&#39;il effectue ses calculs.  </p>
<p>Du coup mon ami avait besoin de trouver un autre moyen d&#39;automatiser sa tâche.<br><br/>  </p>
<p>Une excellente manière de faire de l&#39;analyse de données est d&#39;utiliser le language <a href="https://www.python.org/">Python</a> couplé à <a href="http://pandas.pydata.org/">Pandas</a>, une librairie associée fournissant les outils pour structurer et analyser vos données.<br><br/>  </p>
<p>Si vous êtes familiers de Linux ou Mac, vous pouvez simplement installer Python et Pandas par la ligne de commande, mais je vous recommande d&#39;installer <a href="https://www.continuum.io/anaconda-overview">Anaconda</a> une plateforme complète de sciences de données disponible pour Windows, Mac et Linux.<br><br/>  </p>
<p>Anaconda comprenant de nombreux outils, nous allons commencer par utiliser <a href="http://jupyter.org/">The Jupyter Notebook</a>, une application web qui va nous permettre de créer un petit programme d&#39;analyse sur notre ordinateur.  </p>
<h5 id="utiliser-the-jupyter-notebook">Utiliser The Jupyter Notebook</h5>
<p>Après l&#39;installation d&#39;Anaconda, démarrez The Jupyter Notebook.  </p>
<p>Pour le lancer depuis le terminal sous Linux, ajouter le dossier <code>anaconda/bin</code> dans votre chemin principal (path): <code>export PATH=$PATH:&quot;~/anaconda3/bin&quot;</code> (ou ajoutez le directement dans votre fichier <code>~/.bashrc</code>).<br><br/>  </p>
<p>Créez un nouveau dossier sur votre ordinateur et accédez-y dans Jupyter:<br><img src="../../../images/articles/20160909-Jupyter.png" alt="alt text" title="My program folder"></p>
<p>Créez un nouveau fichier et choisissez &quot;Python&quot; comme language.<br><br/>  </p>
<p>Avant de commencer à rédiger notre programme, pensons à ce que nous essayons d&#39;accomplir.</p>
<ol>
<li>Nous recevons un fichier <code>.csv</code> contenant un certain nombre de colonnes et notamment tous les commentaires de nos commerciaux.</li>
<li>Nous avons une liste de mots considérés comme choquants et allant à l&#39;encontre des standards éthiques de l&#39;entreprise.</li>
<li>Nous avons besoin d&#39;obtenir un rapport contenant le résultat de la comparaison entre les mots dans la liste et les commentaires de notre fichier source.</li>
</ol>
<p>Afin de tester, vous pouvez générer un faux fichier source avec <a href="https://www.mockaroo.com/">Mockaroo</a> ou <a href="http://www.csvgenerator.com/">CSVGenerator</a>.  </p>
<p>Ajoutez par exemple 6 colonnes [&#39;id, first_name, last_name, email, gender, comments&#39;] et générez un fichier de 1000 lignes ou plus (Faites des tests d&#39;échelle avant d&#39;utiliser le programme en production). Pour les commentaires générez du texte aléatoire de type &quot;Lorem Ipsum&quot;.<br><br/>  </p>
<p>Donc nous avons un fichier un source nommé &quot;MOCK_DATA.csv&quot;.<br><br/>  </p>
<p>Nous pouvons créer un prototype de notre programme.</p>
<h5 id="ecrire-un-petit-programme">Ecrire un petit programme</h5>
<p>Commencez par importer les librairies nécessaires pour gérer le fichier csv et Pandas pour jouer avec.  </p>
<pre><code>\1 import csv  
\2 import pandas as pd
</code></pre><p>Ajoutez tous les mots choquants à rechercher.  </p>
<pre><code>\3 words = [&#39;lorem&#39;, &#39;ipsum&#39;, &#39;consequat&#39;]  
</code></pre><p>Vous pouvez aussi remplacer la ligne ci-dessus avec:  </p>
<pre><code>\3 words = pd.read_csv(&#39;OFFENDING_WORDS.csv&#39;)  
</code></pre><p>Cela vous permettra de garder la liste de mots choquants dans un fichier externe.  </p>
<p>Attention dans ce cas, les mots doivent être sur la première ligne et non la première colonne puisque Pandas lit la première ligne par défaut.<br><br/>  </p>
<p>Ensuite créez un &quot;dataframe&quot; appelé &#39;sourceFile&#39; contenant notre source de données et nettoyez la colonne de commentaires pour supprimer toutes ponctuation et majuscules.  </p>
<pre><code>\4 sourceFile = pd.read_csv(&#39;MOCK_DATA.csv&#39;)  
\5 sourceFile[&#39;comments&#39;] = sourceFile.comments.str.lower().replace(&#39;[^A-Za-z0-9]+&#39;,&#39; &#39;, regex=True)  
\6 print(sourceFile.head(5))  
</code></pre><p>Créez également un &quot;dataframe&quot; contenant les données à exporter dans un autre fichier &#39;.csv&#39; pour pouvoir faire vos analyses.  </p>
<pre><code>\7 exportFile = pd.DataFrame([])  
</code></pre><p>Vérifiez toute concordance entre les commentaires et les mots choquants.  </p>
<pre><code>\8 for word in words:
\9 sourceFile_words = sourceFile[sourceFile[&#39;comments&#39;].str.contains(word)]
</code></pre><p>S&#39;il y a concordance, ajoutez les colonnes &#39;id&#39; et &#39;comments&#39; au rapport.   </p>
<p>Toute autre colonne peut également être ajoutée.  </p>
<pre><code>\10 exportFile = exportFile.append(pd.DataFrame( data={&quot;words&quot;: word, &quot;id&quot;: sourceFile_words[&#39;id&#39;], &quot;comments&quot;: sourceFile_words[&#39;comments&#39;]}))  
</code></pre><p>Exportez le rapport dans un fichier &#39;.csv&#39; nommé &#39;analysisResults&#39;.  </p>
<p>Ensuite affichez les résultats de l&#39;analyse dans la console pour une vérification rapide.  </p>
<pre><code>\11 exportFile.to_csv(&#39;analysisResults.csv&#39;)  
\12 print(exportFile)  
</code></pre><h5 id="lancer-le-programme">Lancer le programme</h5>
<p>Il y a plusieurs manières de lancer notre programme et d&#39;obtenir le rapport attendu.<br><br/>  </p>
<p>Pour les utilisateurs de Linux et Mac, la façon la plus simple est de créer un nouveau terminal sous Jupyter.  </p>
<p>Pour les utilisateur de Windows, puisque le terminal n&#39;est <a href="https://github.com/jupyter/notebook/issues/172">pas supporté</a> lancez le programme <a href="http://pythoncentral.io/execute-python-script-file-shell/">en dehors de Jupyter.</a><br><br/></p>
<p>Dans le terminal de Jupyter, naviguez jusqu&#39;au dossier contenant votre programme - Dans mon cas <code>/Desktop/Semantic Analysis Program</code>.<br><br/>  </p>
<p>Exécutez le programme avec la commande <code>python3</code>.  </p>
<pre><code>$ cd ~/Desktop/Semantic Analysis Program  
$ python3 semanticAnalysis.py  
</code></pre><p>Vérifiez les résultats dans la console et que le fichier &#39;analysisResults.csv&#39; a été correctement créé.<br><img src="../../../images/articles/20160909-jupyter2.png" alt="alt text" title="Jupyter Terminal"><br><br/>  </p>
<p>Comme vous pouvez le voir, il n&#39;a fallût que quelques secondes pour analysez le fichier et sortir un rapport clair au lieu de quelques minutes/heures sous Excel.<br><br/>  </p>
<p>Vous pouvez donc consacrer plus de temps à des tâches à plus de valeur ajoutée comme utiliser des outils de visualization pour trouver des présentez les résultats.<br><br/></p>
<p><strong>08/10/2016 - UPDATE</strong>  </p>
<p>Après avoir testé le code ci-dessus avec des données de production, j&#39;ai dû faire quelques ajustements.<br><br/></p>
<p>Puisque l&#39;encodage de certains fichiers csv ne sont pas lus correctement, il est préférable d&#39;indiquer l&#39;encodage pendant la lecture du fichier:<br><code>\4 sourceFile = pd.read_csv(&#39;MOCK_DATA.csv&#39;, encoding=&#39;utf-8&#39;)</code></p>
<p>Ensuite, il est apparu que les caractères chinois n&#39;étaient pas lu et que les mots extraits devaient être identiques à ceux du fichier source, donc j&#39;ai dû modifier les lignes de nettoyage et d&#39;extraction des données:</p>
<pre><code>\5 sourceFile[&#39;comments&#39;] = sourceFile.comments.str.lower().replace(&#39;[.!?:,;]+&#39;,&#39; &#39;, regex=True)
</code></pre><pre><code>\9 sourceFile_words = sourceFile[sourceFile[&#39;comments&#39;].str.contains(r&#39;(?:\s|^)&#39;+word+&#39;(?:\s|$)&#39;, na=False)]
</code></pre><p><code>na=False</code>  assure que si certaines cellules n&#39;ont pas de données, le programme va simplement considérer qu&#39;elles ne correspondent pas à la recherche.<br><br/></p>
<p>Après ces changements, la programme a été capable de lire des fichiers csv de plus de 250,000 lignes.<br><br/></p>
<p><em>TIP:</em> Si vous avez des problèmes avec les fichiers transformés sous Excel, pensez à utiliser LibreOffice.</p></article></div></div><div class="row"><div id="disqus_thread"></div><script>var disqus_config = function () {
     this.page.url = myUrl;
     this.page.identifier = id; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
     var d = document, s = d.createElement('script');
     s.src = '//chdecultot.disqus.com/embed.js';
     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
     })();</script><noscript>Please enable JavaScript to view the: a(href="https://disqus.com/?ref_noscript") comments powered by Disqus.
</noscript></div></div></div></div></section></div></main><footer><div id="footer" class="container"><div class="center-align"><a href="https://twitter.com/chdecultot"><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z"></path></svg></a><a href="https://github.com/chdecultot" style="margin-left: 5px;"><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"></path></svg></a><a href="https://fr.linkedin.com/in/chdecultot" style="margin-left: 5px;"><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" d="M21,21H17V14.25C17,13.19 15.81,12.31 14.75,12.31C13.69,12.31 13,13.19 13,14.25V21H9V9H13V11C13.66,9.93 15.36,9.24 16.5,9.24C19,9.24 21,11.28 21,13.75V21M7,21H3V9H7V21M5,3A2,2 0 0,1 7,5A2,2 0 0,1 5,7A2,2 0 0,1 3,5A2,2 0 0,1 5,3Z"></path></svg></a></div><div class="footer-copyright center-align"><p> 
©2016 Charles-Henri Decultot</p></div></div></footer><script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script><script type="text/javascript" src="../../../scripts/malarkey.min.js"></script><script type="text/javascript" src="../../../scripts/main.js"></script><script id="dsq-count-scr" src="//chdecultot.disqus.com/count.js" async></script></body></html>