<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Independant business consultant, proficient developer. Focused on improving efficiency through technology."><meta name="keywords" content="Technology,Business Tools,Website,Consulting"><meta name="author" content="Charles-Henri Decultot"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"><link rel="stylesheet" href="../../../styles/main.css"><link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon"><title>Charles-Henri Decultot | Business and Technology Consultant</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      
ga('create', 'UA-35025071-2', 'auto');
ga('send', 'pageview');        

</script></head><body class="blue-grey lighten-5 blue-grey-text text-darken-2"> <header><div class="chip"><a href="/"><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" d="M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"></path></svg></a></div></header><main><div class="container"><section id="article" class="row"><div class="col s12"><div class="card"><div class="card-image"><img src="../../../images/heroImages/20171022-generate-an-address-book-with-gas.jpg" class="responsive-img"><span class="card-title">Generate an address book from you Gmail Contacts</span></div><div class="card-content"><div id="blogNav" class="row"><div id="blogHeader"><img id="logo" src="../../../images/CH-round.png" alt="Charles-Henri Decultot" class="circle"><div id="blogInfo"><strong>Charles-Henri Decultot</strong><br><span>October 22, 2017</span></div></div><div id="socialSharing" class="fixed-action-btn waves-effect waves-light horizontal click-to-toggle"><a href="#"><i class="material-icons">share</i></a><ul><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.chdecultot.com%2Fen%2Farticles%2Fgenerate-an-address-book-from-you-gmail-contacts%2F" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i><img src="../../../images/facebook-48x48.png" srcset="../../../images/facebook-24x24.png 1x, ../../../images/facebook-48x48.png 2x" alt="Facebook Logo"></i></a></li><li><a href="https://plus.google.com/share?url=https%3A%2F%2Fwww.chdecultot.com%2Fen%2Farticles%2Fgenerate-an-address-book-from-you-gmail-contacts%2F" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i><img src="../../../images/Google+-48x48.png" srcset="../../../images/Google+-24x24.png 1x, ../../../images/Google+-48x48.png 2x" alt="Google+ Logo"></i></a></li><li><a href="https://twitter.com/intent/tweet?text=Generate an address book from you Gmail Contactsurl=https%3A%2F%2Fwww.chdecultot.com%2Fen%2Farticles%2Fgenerate-an-address-book-from-you-gmail-contacts%2F" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i><img src="../../../images/Twitter-48x48.png" srcset="../../../images/Twitter-24x24.png 1x, ../../../images/Twitter-48x48.png 2x" alt="Twitter Logo"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.chdecultot.com%2Fen%2Farticles%2Fgenerate-an-address-book-from-you-gmail-contacts%2F&amp;title=Generate an address book from you Gmail Contacts&amp;summary=A google apps script to generate an address book from your Gmail contacts.&amp;source=Charles-Henri Decultot" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i><img src="../../../images/Linkedin-48x48.png" srcset="../../../images/Linkedin-24x24.png 1x, ../../../images/Linkedin-48x48.png 2x" alt="LinkedIn Logo"></i></a></li></ul></div><div id="blogContent"><article><p>In the digital world we live in there might be no reason to use a paper based address book anymore. Unless, for example, you have a centralized organization that keeps all its members information in a Gmail account and wants to share it with its members.</p>
<p>I have developed the below tool for an association in need of generating an address book for its members.<br>Feel free to reuse it and enhance it as you like (MIT licence).<br><br></p>
<p><strong>How does it work ?</strong></p>
<p>Just copy the below in a new Google Script linked to a Google Doc.<br><br></p>
<p>The execution of the script will generate a new address book, nicely formated with a cover picture, in a new Google Doc.<br>Up to you to share it as is, send it in an email or export it as a PDF.<br><br><br><img src="../../../images/articles/20171022-address_book.png" alt="Address Book Preview"><br><br><br><strong>The code to be added in your Google Doc</strong></p>
<p>The code is split in two parts (could be split further for more clarity).<br>Do not forget to change the variable filtering contacts based on their group&#39;s assignment and to add a cover picture in your source Google Doc.<br><br><br>To add it in your Google Drive, create a new Google Doc and go to &quot;Tools &gt; Script Editor&quot;.<br>Replace the existing code in &quot;Code.gs&quot; with the below code.  </p>
<p>Go back to your Google Doc, refresh the page and you can launch the script to generate a new address book.<br>Grant the necessary permissions to your contacts and Drive for the script to be able to work.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// Addition of a menu in your Google Doc</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onOpen</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> ui = DocumentApp.getUi();
  ui.createMenu(<span class="hljs-string">'Address Book'</span>)
      .addItem(<span class="hljs-string">'Generate an Address Book'</span>, <span class="hljs-string">'createAddressBook'</span>)
      .addToUi();
}


<span class="hljs-comment">// Function to generate a new address book</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createAddressBook</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// The script gets the first image available in the Google Doc. It will be used as cover for the address book.</span>
  <span class="hljs-keyword">var</span> image = DocumentApp.getActiveDocument().getBody().getImages()[<span class="hljs-number">0</span>].getBlob();
  <span class="hljs-comment">// A new Doc is created with a name like "My Address Book_22/10/2018"</span>
  <span class="hljs-keyword">var</span> doc = DocumentApp.create(<span class="hljs-string">'My Address Book_'</span>  +  Utilities.formatDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(), <span class="hljs-string">'GMT+2'</span>, <span class="hljs-string">'dd/MM/yyyy'</span>));
  <span class="hljs-keyword">var</span> body = doc.getBody();
  <span class="hljs-keyword">var</span> textBody = body.editAsText();

  <span class="hljs-comment">// The styles that will be applied to different paragraphs</span>
  <span class="hljs-keyword">var</span> style = {};
  style[DocumentApp.Attribute.FONT_SIZE] = <span class="hljs-number">12</span>;
  style[DocumentApp.Attribute.BOLD] = <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">var</span> jobStyle = {};
  jobStyle[DocumentApp.Attribute.FONT_SIZE] = <span class="hljs-number">12</span>;
  jobStyle[DocumentApp.Attribute.BOLD] = <span class="hljs-literal">false</span>;
  jobStyle[DocumentApp.Attribute.ITALIC] = <span class="hljs-literal">true</span>;

  <span class="hljs-comment">// The script gets the account's contacts</span>
  <span class="hljs-keyword">var</span> contacts = ContactsApp.getContacts();


  <span class="hljs-comment">// The image fetched before is inserted as a cover picture in the address book</span>
  <span class="hljs-keyword">var</span> imgParStyle = {};
  imgParStyle[DocumentApp.Attribute.HORIZONTAL_ALIGNMENT] = DocumentApp.HorizontalAlignment.CENTER;
  imgPar = body.appendParagraph(<span class="hljs-string">""</span>).setAttributes(imgParStyle);
  insertedImage = imgPar.insertInlineImage(<span class="hljs-number">0</span>, image);

  <span class="hljs-comment">// The date of issuance is printed at the top of the address book</span>
  issuanceDate = body.appendParagraph(<span class="hljs-string">"Address Book Generated The "</span> +  Utilities.formatDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(), <span class="hljs-string">'GMT+2'</span>, <span class="hljs-string">'dd/MM/yyyy'</span>));
  <span class="hljs-keyword">var</span> dateParStyle = {};
  dateParStyle[DocumentApp.Attribute.FOREGROUND_COLOR] = <span class="hljs-string">'#1c4587'</span>
  issuanceDate.setHeading(DocumentApp.ParagraphHeading.HEADING1);
  issuanceDate.setAttributes(dateParStyle);

  <span class="hljs-comment">// For each contact in the account's contact, different elements are fetched and printed in the address book</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> contacts) {

    <span class="hljs-comment">// Only contacts belonging to a certain group are printed. This part can be removed if all contacts should be printed or modified if contacts belonging to certain groups only should be printed.</span>
    groups = contacts[i].getContactGroups();

    <span class="hljs-comment">// Only contacts belonging to the group "Group A" will be printed in the address book.</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j <span class="hljs-keyword">in</span> groups) {
      <span class="hljs-keyword">if</span> (groups[j].getName() === <span class="hljs-string">"Group A"</span>) {

        <span class="hljs-comment">// The full name will be printed at the top of the paragrah</span>
        <span class="hljs-keyword">var</span> fullName = contacts[i].getFullName();
        <span class="hljs-keyword">if</span> (fullName.length === <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">var</span> paragraph = body.appendParagraph(<span class="hljs-string">"\n"</span>+fullName);
        paragraph.setHeading(DocumentApp.ParagraphHeading.HEADING2);

        <span class="hljs-comment">// Only the first address is printed</span>
        <span class="hljs-keyword">var</span> addresses = contacts[i].getAddresses();
        <span class="hljs-keyword">if</span> (addresses.length !== <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">var</span> address = paragraph.appendText(<span class="hljs-string">"\n"</span>+addresses[<span class="hljs-number">0</span>].getAddress());
          address.setAttributes(style);  
        }

        <span class="hljs-comment">// All phone numbers are printed</span>
        <span class="hljs-keyword">var</span> phones = contacts[i].getPhones();
        <span class="hljs-keyword">if</span> (phones.length !== <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k <span class="hljs-keyword">in</span> phones) {
            <span class="hljs-keyword">var</span> phone = paragraph.appendText(<span class="hljs-string">"\n"</span>+phones[k].getPhoneNumber());
            phone.setAttributes(style);
          }
        }

        <span class="hljs-comment">// The first email address is printed</span>
        <span class="hljs-keyword">var</span> emails = contacts[i].getEmails();
        <span class="hljs-keyword">if</span> (emails.length !== <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">var</span> email = paragraph.appendText(<span class="hljs-string">"\n"</span>+emails[<span class="hljs-number">0</span>].getAddress());
          email.setAttributes(style);
        }

        <span class="hljs-comment">// The first job title is printed in italic at the bottom of the paragraph</span>
        <span class="hljs-keyword">var</span> companies = contacts[i].getCompanies();
        <span class="hljs-keyword">if</span> (companies.length !== <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">var</span> job = paragraph.appendText(<span class="hljs-string">"\n"</span>+companies[<span class="hljs-number">0</span>].getJobTitle());
          job.setAttributes(jobStyle);
        }
      }
    }
  }
   <span class="hljs-comment">// When the script is fully executed, the below message is printed</span>
   DocumentApp.getUi().alert(<span class="hljs-string">'Your address book is available in the root folder of your Google Drive'</span>)
}
</code></pre>
<h2 id="-br-"></br></h2>
<p>You need an analysis for your project or advices on this topic ? Don&#39;t hesitate to contact me at <a href="https://www.dokos.io">DOKOS</a>, I&#39;ll be happy to help you!</p>
</article></div></div><div class="row"><div id="disqus_thread"></div><script>var disqus_config = function () {
     this.page.url = myUrl;
     this.page.identifier = id; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
     var d = document, s = d.createElement('script');
     s.src = '//chdecultot.disqus.com/embed.js';
     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
     })();</script><noscript>Please enable JavaScript to view the: a(href="https://disqus.com/?ref_noscript") comments powered by Disqus.
</noscript></div></div></div></div></section></div></main><footer><div id="footer" class="container"><div class="center-align"><a href="https://twitter.com/chdecultot"><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z"></path></svg></a><a href="https://github.com/chdecultot" style="margin-left: 5px;"><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"></path></svg></a><a href="https://fr.linkedin.com/in/chdecultot" style="margin-left: 5px;"><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" d="M21,21H17V14.25C17,13.19 15.81,12.31 14.75,12.31C13.69,12.31 13,13.19 13,14.25V21H9V9H13V11C13.66,9.93 15.36,9.24 16.5,9.24C19,9.24 21,11.28 21,13.75V21M7,21H3V9H7V21M5,3A2,2 0 0,1 7,5A2,2 0 0,1 5,7A2,2 0 0,1 3,5A2,2 0 0,1 5,3Z"></path></svg></a></div><div class="footer-copyright center-align"><p> 
©2016-2017 Charles-Henri Decultot</p></div></div></footer><script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script><script type="text/javascript" src="../../../scripts/malarkey.min.js"></script><script type="text/javascript" src="../../../scripts/main.js"></script><script id="dsq-count-scr" src="//chdecultot.disqus.com/count.js" async></script></body></html>